<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN"
"http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="content-type" content="text/html; charset=iso-8859-1">
<title>RSA: how to factorize N given d</title>
<meta name="description" content="RSA: how to factorize N given d">
<meta name="keywords" content="mathematics, RSA algorithm, cryptography">

<meta name="copyright" content="Copyright (C) 2012 DI Management Services Pty Limited ABN 78 083 210 584 All Rights Reserved">
<meta name="author" content="David Ireland, DI Management Services Pty Limited, Australia, www.di-mgt.com.au">

<meta http-equiv="content-style-type" content="text/css">
<link href="diprint.css" rel="stylesheet" type="text/css" media="handheld">
<link href="distyle3.css" rel="stylesheet" type="text/css" media="Screen">
<link href="diprint.css" rel="stylesheet" type="text/css" media="print">

<!-- BEGIN MATHJAX-STUFF -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}});
</script>
<script type="text/javascript"
  src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
<!-- END MATHJAX-STUFF -->

</head>
<body>


<!-- BEGIN BODY-BLOCK -->
<div class="w-body-text">
<a href="http://www.di-mgt.com.au/rsa_factorize_n.html"><h2> SOURCE </h2>	</a>
<h1>RSA: how to factorize N given d</h1>
<hr class="noshow">

<!-- Body Text begins -->

<p>
This page explains how to factorize the RSA modulus $N$ given the public and private exponents, $e$ and $d$.
</p>

<!-- MORE MATHJAX-STUFF -->
<noscript>
<div style="color:#CC0000; text-align:center; font-weight:bold; border:1px red dashed; padding:5px;">
We use <a href="http://www.mathjax.org/">MathJax</a> to display the mathematics on this page.
Please enable JavaScript in your browser for it to work.
</div>
</noscript>

<h2>Introduction</h2>
<p>
For the RSA algorithm, we have a public key $(N, e)$ and a private key $(N, d)$ where $N = pq$ is the product of two distinct primes $p$ and $q$,
and the numbers $e$ and $d$ satisfy the relation $ed \equiv 1 \mod \phi(N)$ where $\phi(N) = (p-1)(q-1)$.
$N$ should be a large number which is impossible to factorize, typically of length 1024 bits. 
The numbers $N$ and $e$ can be made public, but $d$, $p$, $q$ and $\phi(N)$ are kept secret by the user of the private key. 
See our <a href="rsa_alg.html">RSA Algorithm</a> and <a href="rsa_theory.html">RSA Theory</a> pages for more information.
</p>

<h2>The problem: given <var>d</var> and <var>e</var>, can we factorize <var>N</var>?</h2>
<p>
Surprisingly, there isn't a simple formula to compute 
the factors $p$ and $q$ of the modulus $N$ given just the public and private exponents, $e$ and $d$.
But there is a nice efficient algorithm using a random $g$ which should succeed about half the time.
</p>
<p>
Initially we compute $k = de-1$. We then choose a random integer $g$ in the range $1 \lt g \lt N$. 
Now $k$ is an even number, where $k = 2^tr$ with $r$ odd and $t\geq1$,
so we can compute  $x = g^{k/2}, g^{k/4}, \ldots, g^{k/2^t} \pmod N$
until $x \gt 1$ and $y = \gcd(x-1, N) \gt 1$. If so, then one of our factors, say $p$, is equal to $y$,
and the other is $q=N/y$ and we are done. If we don't find a solution, then we choose another random $g$.

</p>

<div style="margin: 0 2em 0 2em; font-family: Georgia, Times, serif;font-size:110%;">
<hr style="height:3px; background: black">
<b>Algorithm</b>
<hr style="height:1px">
<b>Input:</b> $N$, $e$, $d$. <br>
<b>Output:</b> $p$ and $q$ where $pq = N$.
<ol style="line-height: 180%;">
<li><span style="font-family: arial,sans-serif">[Initialize]</span> 
	Set $k \leftarrow de - 1$.</li>
<li><span style="font-family: arial,sans-serif">[Try a random g]</span> 
	<!-- Set $g \overset{R}{\leftarrow} \{2,\ldots,N-1\}$ -->
	Choose $g$ at random from $\{2,\ldots,N-1\}$
	and set $t \leftarrow k$.
</li>
<li><span style="font-family: arial,sans-serif">[Next t]</span>
	If $t$ is divisible by $2$, set $t \leftarrow t/2$ and
	$x \leftarrow g^t \mod N$.
	Otherwise go to step 2.
</li>
<li><span style="font-family: arial,sans-serif">[Finished?]</span>
If $x \gt 1$ and $y = \gcd(x-1, N) \gt 1$ then
set $p \leftarrow y$ and $q \leftarrow N/y$, output $(p,q)$
and terminate the algorithm.
Otherwise go to step 3.
</li>
</ol>
<hr style="height:1px">
</div>

<h2>A simple example</h2>
<p>
<b>Input:</b> $N=25777$, $e=3$, $d=16971$.
</p>

<pre>
k=de-1=50912

Trying g=2
t=25456
x=g^t mod N=1
t=12728
x=g^t mod N=1
t=6364
x=g^t mod N=1
t=3182
x=g^t mod N=25776
y=gcd(x-1,N)=1
t=1591
x=g^t mod N=12709
y=gcd(x-1,N)=1

Trying g=5
t=25456
x=g^t mod N=1
t=12728
x=g^t mod N=1
t=6364
x=g^t mod N=1
t=3182
x=g^t mod N=15050
y=gcd(x-1,N)=149
p=149
q=N/p=25777/149=173

Output: p=173, q=149
</pre>
<p>Note that we swapped $p$ and $q$ here in accordance with the convention that $p \gt q$.
</p>

<h2>Code to do this with large integers</h2>
<p>
We use our <a href="bigdigits.html">BigDigits multiple-precision arithmetic software</a> to implement this algorithm for large integers.
The code is <a href="t_bdRsaFactorN.c.html">here</a>. Note that we cheat slightly by just choosing small primes $g=2,3,5,7,11,\ldots$ instead of random
values for $g$. We should get a result within a few tries.
</p>
<p>The output for the 508-bit example from [KALI93] should be as follows:
</p>
<pre class="output">
Input:
n=a66791dc6988168de7ab77419bb7fb0c001c62710270075142942e19a8d8c51d053b3e3782a1de
5dc5af4ebe99468170114a1dfe67cdc9a9af55d655620bbab
e=10001
d=123c5b61ba36edb1d3679904199a89ea80c09b9122e1400c09adcf7784676d01d23356a7d44d6b
d8bd50e94bfc723fa87d8862b75177691c11d757692df8881
k=de-1=3912086784511471289561151952301925086168946454709316095960618800742799369
17336572480276788289479037864022477149770074463282234977724373626952267297821665
0880
Trying g=2
k1=19560433922557356447805759761509625430844732273546580479803094003713996845866
82862401383941447395189320112385748850372316411174888621868134761336489108325440
x=g^{k1} mod N=1
k1=97802169612786782239028798807548127154223661367732902399015470018569984229334
1431200691970723697594660056192874425186158205587444310934067380668244554162720
x=g^{k1} mod N=1
k1=48901084806393391119514399403774063577111830683866451199507735009284992114667
0715600345985361848797330028096437212593079102793722155467033690334122277081360
x=g^{k1} mod N=1
k1=24450542403196695559757199701887031788555915341933225599753867504642496057333
5357800172992680924398665014048218606296539551396861077733516845167061138540680
x=g^{k1} mod N=15093433718268440426031307226229967304531280096624631832802133467
75503932569655700680786404281006639009247399377287658652217161876478659236009863
49707225
y=gcd(x-1,N)=2323495016218899338815592763008533131685106005533447038236880433183
4850828939
Output:
p=33d48445c859e52340de704bcdda065fbb4058d740bd1d67d29e9c146c11cf61
q=335e8408866b0fd38dc7002d3f972c67389a65d5d8306566d5c4f2a5aa52628b
</pre>
<p>which is indeed the correct factorization.
</p>

<h2><a name="references"></a>References</h2>
<ul>
<li><b><a name="BONE99" id="BONE99"></a>[BONE99]</b>
Boneh, D.
<cite>Twenty Years of Attacks on the RSA Cryptosystem</cite>,
Notices of the American Mathematical Society, 46(2):203-213, 1999,
&lt;<a href="https://e-math1.ams.org/notices/199902/boneh.pdf">link</a>&gt;</li>


<li><b><a name="KALI93" id="KALI93"></a>[KALI93]</b>
Burton Kalinski. <cite>Some Examples of the PKCS Standards</cite>, RSA Laboratories, 1999,
&lt;<a href="ftp://ftp.rsasecurity.com/pub/pkcs/ascii/examples.asc">link</a>&gt;.
</li>

</ul>

<h2><a name="contactus"></a>Contact us</h2>
<p>
To comment on this page or to tell us about a mistake, please <a href="http://www.di-mgt.com.au/contactmsg.php?topic=Mathematics" title="Send us an email">send us a message</a>.
</p>

<p><i>This page first published 1 December 2012. Last updated 24 December 2012. </i></p><!-- $CUSTOM$ -->

</div> <!-- END BODY-BLOCK -->

<!-- BEGIN FOOTER-BLOCK -->
<!-- Page footer - Rule, Copyright and Text-style Links -->
<hr class="noshow">
<div class="w-footer">
<!-- Show off valid WC3 -->

<!-- end of Valid WC3 -->

<div class="f-copyright">
	Copyright &copy; 2012 DI Management Services Pty Limited 
	ABN&nbsp;78&nbsp;083&nbsp;210&nbsp;584
	Australia.<br>

	<a class="links" href="http://www.di-mgt.com.au">
<b>www.di-mgt.com.au</b></a>.
	All rights reserved.
</div>                                             

</div> <!-- END FOOTER-BLOCK -->

</body></html>
